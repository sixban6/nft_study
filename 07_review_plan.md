# å­¦ä¹ å¤ä¹ ä¸è®°å¿†å·©å›ºè®¡åˆ’ (å¯¹æŠ—é—å¿˜æ›²çº¿)

å­¦ä¹  `nftables` æœ€æ€•çš„ä¸æ˜¯å½“æ—¶å¬ä¸æ‡‚ï¼Œè€Œæ˜¯å­¦å®Œå‡ ä¸ªæœˆåï¼Œé¢å¯¹éœ€è¦é…é˜²ç«å¢™çš„æœåŠ¡å™¨ï¼Œå¤§è„‘ä¸€ç‰‡ç©ºç™½ã€‚

æœ¬è®¡åˆ’åŸºäº**è‰¾å®¾æµ©æ–¯é—å¿˜æ›²çº¿ (Ebbinghaus Forgetting Curve)** è®¾è®¡ï¼Œæ—¨åœ¨å¸®ä½ å°†ä¸Šé¢ 6 ä¸ªé˜¶æ®µå­¦åˆ°çš„å†…å®¹ï¼Œä»â€œçŸ­æœŸè®°å¿†â€å›ºåŒ–ä¸ºâ€œé•¿æœŸçš„è‚Œè‚‰è®°å¿†â€ã€‚

---

## æ ¸å¿ƒå¤ä¹ åŸåˆ™

1. **ä¸èƒŒå‘½ä»¤ï¼ŒèƒŒé€»è¾‘**ï¼šä¸è¦æ­»è®° `add rule inet filter...`ï¼Œåªéœ€è¦è®°ä½â€œå‘è¡¨é‡Œçš„é“¾é‡ŒåŠ è§„åˆ™â€è¿™ä¸ªé€»è¾‘ã€‚
2. **å¤šæ•²å¤šé”™ï¼Œå¤šé”™å¤šè®°**ï¼šæ¯æ¬¡å¤ä¹ æ—¶ï¼Œ**åŠ¡å¿…åœ¨è™šæ‹ŸæœºåŠ¨æ‰‹æ•²ä¸€é**ï¼Œä¸è¦åªç”¨çœ¼ç›çœ‹ã€‚æ•²é”™ä¸€æ¬¡æ’éšœçš„è®°å¿†ï¼Œæ¯”çœ‹ä¹¦åééƒ½æ·±åˆ»ã€‚
3. **ç»“åˆå®é™…ä¸šåŠ¡**ï¼šé‡åˆ°é—®é¢˜ä¸è¦å» Google â€œå¦‚ä½•ç”¨ iptables è§£å†³â€ï¼Œå¼ºåˆ¶è‡ªå·±æƒ³â€œå¦‚ä½•ç”¨ nftables è§£å†³â€ã€‚

---

## ğŸ“… è‰¾å®¾æµ©æ–¯è®°å¿†å‘¨æœŸè¡¨

è¯·åœ¨æ—¥å†ä¸Šæ‰“å¡ä»¥ä¸‹å¤ä¹ èŠ‚ç‚¹ã€‚

### é˜¶æ®µä¸€ï¼šåˆå­¦æœŸ (çŸ­æœŸè®°å¿†å¯¹æŠ—)

*   [ ] **å­¦ä¹ å½“å¤© (Day 0)ï¼š**
    *   **ä»»åŠ¡ï¼š** å­¦ä¹  [Stage 1](01_stage1_basic.md) åˆ° [Stage 3](03_stage3_advanced_structures.md)ã€‚
    *   **å®æˆ˜ï¼š** å†™å‡ºåŒ…å« Tableã€Chain å’ŒåŸºç¡€ Rule çš„è„šæœ¬ï¼ŒæˆåŠŸç”¨é›†åˆ (Set) å±è”½ä»»æ„ 3 ä¸ª IPã€‚
*   [ ] **æ¬¡æ—¥å¤ä¹  (Day 1)ï¼š**
    *   **ä»»åŠ¡ï¼š** å­¦ä¹  [Stage 4](04_stage4_state_machine.md) åˆ° [Stage 6](06_stage6_best_practices.md)ã€‚å›é¡¾å‰ä¸‰å¤©å†…å®¹ã€‚
    *   **å®æˆ˜ï¼š** é»˜å†™å‡ºä¸€å¼ åŒ…å« `established,related accept` çŠ¶æ€æœºçš„ Web æœåŠ¡å™¨é˜²å¾¡è„šæœ¬ã€‚
*   [ ] **ç¬¬ä¸‰å¤© (Day 3)ï¼š**
    *   **ä»»åŠ¡ï¼š** ä¸çœ‹ä»»ä½•æ–‡æ¡£ï¼Œç»™ä½ çš„è™šæ‹Ÿæœºé…ä¸€å¥—åªå¼€ SSHï¼Œå…¶ä»–å…¨å…³ï¼Œä½†å…è®¸å¯¹å¤–è®¿é—®çš„è§„åˆ™ã€‚
    *   **å¿ƒæ³•ï¼š** å¿˜æ‰è¯­æ³•æ²¡å…³ç³»ï¼Œåªè¦ä½ èƒ½æƒ³èµ·ç”¨ `vmap` åˆ†å‘ç«¯å£ï¼Œç”¨ `ct state` ç®¡çŠ¶æ€ï¼Œå»æŸ¥è¯­æ³•æ‰‹å†Œè¡¥å…¨å³å¯ã€‚

### é˜¶æ®µäºŒï¼šå·©å›ºæœŸ (ä¸­é•¿æœŸè®°å¿†è½¬åŒ–)

*   [ ] **ç¬¬ä¸ƒå¤© (Day 7)ï¼š**
    *   **ä»»åŠ¡ï¼š** åšä¸€æ¬¡å®Œæ•´çš„å›é¡¾ã€‚é‡ç‚¹å¤ä¹ â€œé›†åˆ(Sets)â€ã€â€œå­—å…¸(Vmap)â€ å’Œ â€œNAT åŸç†â€ è¿™ä¸‰ä¸ªæœ€å®¹æ˜“æ··æ·†çš„é«˜çº§ç‰¹æ€§ã€‚
    *   **æµ‹éªŒï¼š** å®Œæˆæœ¬ä¹¦é™„å¸¦çš„ [æœŸæœ«æµ‹è¯•æ¼”ç»ƒå·](08_final_exam.md)ã€‚å¦‚æœä½ èƒ½åŠæ ¼ï¼Œè¯´æ˜çŸ¥è¯†éª¨æ¶å·²ç»å½¢æˆã€‚
*   [ ] **ç¬¬åäº”å¤© (Day 15)ï¼š**
    *   **å®æˆ˜æŒ‘æˆ˜ï¼š** æ‰¾ä¸€å°å¸¦æœ‰ Docker çš„æœºå™¨ï¼Œå°è¯•ç”¨ `nftables` åˆ†æ Docker ç”Ÿæˆçš„ NAT è§„åˆ™ã€‚
    *   **è°ƒè¯•ï¼š** æ•…æ„å†™é”™ä¸€æ¡ç«¯å£é…ç½®ï¼Œä½¿ç”¨ `meta nftrace set 1` æ‰¾åˆ°è¿™ä¸ªåŒ…åœ¨å“ªé‡Œè¢«ä¸¢å¼ƒçš„ã€‚

### é˜¶æ®µä¸‰ï¼šé•¿æ•ˆæœŸ (è‚Œè‚‰è®°å¿†å½¢æˆ)

*   [ ] **ç¬¬ä¸‰åå¤© (Day 30)ï¼š**
    *   **ä»»åŠ¡ï¼š** é—­å·ã€‚æ‰“å¼€ä¸€ä¸ªç©ºç™½æ–‡ä»¶ï¼Œèƒ½åœ¨ 5 åˆ†é’Ÿå†…æ•²å‡ºä¸€ä¸ªå¸¦çŠ¶æ€æœºçš„å¯ç”¨åŸºç¡€é˜²ç«å¢™æ¨¡æ¿ã€‚
*   [ ] **ä¸‰ä¸ªæœˆå (Day 90)ï¼š**
    *   **ä»»åŠ¡ï¼š** åœ¨å…¬å¸æˆ–ä¸ªäººé¡¹ç›®ä¸­ï¼Œæ‰¾æœºä¼šæŠŠä¸€å°æœºå™¨çš„è€æ—§ `iptables` è§„åˆ™ï¼Œæ‰‹å†™æ›¿æ¢ä¸ºç­‰æ•ˆä¸”æ›´ä¼˜é›…çš„ `nftables` è§„åˆ™ã€‚å½“ä½ å®Œæˆè¿™ä¸€æ¬¡é‡æ„ï¼Œå½»åº•ç®—æ˜¯æ¯•ä¸šäº†ã€‚

---

## ğŸ§  è®°å¿†æç¤ºå¡ç‰‡ (Cheat Sheet)

æŠŠè¿™å‡ å¥è¯èƒŒä¸‹æ¥ï¼ˆæˆ–è€…è´´åœ¨å·¥ä½ä¸Šï¼‰ï¼š

1. **ç»“æ„è¯æ±‡**ï¼š`Table` (å¤§è¡¨/å‘½åç©ºé—´) -> `Chain` (é“¾/å‡½æ•°) -> `Rule` (è§„åˆ™/è¯­å¥)ã€‚
2. **çŠ¶æ€å››å…„å¼Ÿ**ï¼š`new` (åˆè§), `established` (ç†Ÿäºº), `related` (å…³ç³»æˆ·), `invalid` (æµæ°“)ã€‚ä¿æŠ¤è‡ªå·±å°±ä¸€æ¡ï¼š`ct state established,related accept`ã€‚
3. **åŠ¨ä½œæ§åˆ¶**ï¼š`accept` (ä¸‹è½¦), `drop` (æ‰å´–), `reject` (è¢«è¸¹), `jump/goto` (è½¬æœº)ã€‚
4. **NAT ä¸¤å¤§æŠ¤æ³•**ï¼šæ”¹æºå¤´ (SNAT) å» `postrouting`ï¼›æ”¹ç›®çš„åœ° (DNAT/ç«¯å£æ˜ å°„) å» `prerouting`ã€‚
5. **é«˜æ€§èƒ½æ ¸å¼¹**ï¼šå¤šä¸ª IP ç”¨é›†åˆ `{}`ã€‚å¤šæ•°å€¼åˆ†æ”¯ç”¨å­—å…¸ `vmap`ã€‚
6. **é˜²æ–­ç½‘ç¥æŠ€**ï¼šé…ç½®é¡¶ç«¯æ°¸è¿œåŠ ä¸€å¥ `flush ruleset`ã€‚ä½¿ç”¨ `nft -f` åŸå­æäº¤ã€‚
