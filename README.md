# 像学 C 语言一样学 nftables：课程大纲与自学指南

欢迎来到 **『像学 C 语言一样学 nftables』** 学习指南！本仓库旨在提供一套重原理、重实用、重实战，并遵循“由浅入深”学习路径的 `nftables` 教程。

## 为什么会有这套教程？

很多网络工程师或开发者在学习 `iptables` 或 `nftables` 时，常常被碎片化的命令和无穷无尽的参数所淹没。实际上，防火墙规则的本质就如同编写程序代码。

因此，本教程完全采用 **“类比 C 语言编程”** 的思维模型来讲解 `nftables`：
- **Table（表）** 对应 `namespace`；
- **Chain（链）** 对应 `函数 (Function)`；
- **Rule（规则）** 对应 `语句 (Statement)`；
- **Sets/Dictionaries** 对应 `数组与哈希表`；
- **控制流** 对应 `if-else` 和 `switch-case`。

当你学完这套内容，面对任何复杂的网络流量控制，你都能像阅读 C 语言代码一样，一眼看穿它的执行逻辑。

## 动手实践 (Docker Lab)

为了让学习不仅仅停留在理论，本教程在每一章节都配备了**实战验证**环节。
为了防止你把自己的宿主机网络搞崩溃，我们强烈建议使用 Docker 容器（比如轻量级的 Alpine Linux）作为防火墙靶机。
结合网络军刀 `nc` (netcat)，你将能直观地看到 `nftables` 是如何将恶意流量无情 `drop`、又如何将 HTTP 请求顺畅 `accept` 的。

关于靶机的具体搭建命令，请直接查阅 [第一阶段](01_stage1_basic.md) 中的说明。

## 目录结构与学习路径

整个学习资料分为以下几个部分：

* [第一阶段：基础入门与“Hello World”](01_stage1_basic.md)
* [第二阶段：控制流与逻辑判断](02_stage2_packet_filtering.md)
* [第三阶段：高级数据结构与优化](03_stage3_advanced_structures.md)
* [第四阶段：状态机与内存管理](04_stage4_state_machine.md)
* [第五阶段：NAT 与路由指针](05_stage5_nat.md)
* [第六阶段：工程化、调试与最佳实践](06_stage6_best_practices.md)

**附加内容：**
* [复习与记忆巩固计划 (艾宾浩斯记忆法)](07_review_plan.md)
* [期末测试演练卷 (含答案解析)](08_final_exam.md)

## 如何使用本资料？

1. **循序渐进阅读：** 建议从 `01` 到 `06` 按顺序阅读，每个阶段都有配套的“课后实战”。
2. **沉浸式动手：** 教程中给出的 `.nft` 配置脚本以及 `nc` 探测命令，请务必在你的 Docker 靶机与宿主机之间实际敲打运行。
3. **搭配复习计划：** 阅读 [07_review_plan.md](07_review_plan.md) 制定你自己的学习时间表，对抗遗忘曲线，形成长期甚至肌肉记忆。
4. **期末考核：** 学完所有内容后，利用 [08_final_exam.md](08_final_exam.md) 检验你的学习成果。

### 导出为 EPUB 电子书

为了方便在阅读器或移动设备上随时查阅，本项目提供了一键打包电子书的脚本（依赖 `pandoc`）。
只需在项目根目录执行：
```bash
./build_epub.sh
```
成功后，当前目录会生成 `nftables_tutorial.epub` 文件。

## 许可证

本教程采用 [MIT License](LICENSE) 授权，你可以自由使用、修改并分发本仓库的内容，但请保留原作者声明。
